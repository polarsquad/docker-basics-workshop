<!DOCTYPE HTML>

<html>

<head>
	<title>Docker networking &middot; Docker Basics Workshop</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	
	
	
	<meta http-equiv="content-language" content="en-us" />
	<meta name="generator" content="Hugo 0.74.2" />
	<link rel="stylesheet" href="https://polarsquad.github.io/docker-basics-workshop/css/index.css">
	<link rel="apple-touch-icon" href="https://polarsquad.github.io/docker-basics-workshop/apple-touch-icon.png">
	<link rel="shortcut icon" href="https://polarsquad.github.io/docker-basics-workshop/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
	 crossorigin="anonymous">
</head>
	<body>
		<div class="Wrapper">
			<div class="Container">
				<div class="Header">
  <a href="https://polarsquad.github.io/docker-basics-workshop/">
	<div class="Title center">
		
			<img alt="Docker Basics Workshop Logo" src="https://polarsquad.github.io/docker-basics-workshop/290x132_PolarSquad_logo.png" height="140" />
		
		<span class="text">Docker Basics Workshop</span>
		<span class="subtext"></span>
	</div>
  </a>
</div>

				<div class="Content-wrapper">
					<div class="Sidebar">
	<div class="Menu">
		<div class="item">
			<a href="https://polarsquad.github.io/docker-basics-workshop/">Home</a>
		</div>
		
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/02-preparation/">Preparation</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/03-running-your-first-app/">Running your first Docker app</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/04-managing-containers/">Managing Docker containers</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/05-building-your-first-app/">Building your first Docker app</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/06-publishing-images/">Publishing a Docker image</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/07-volumes/">Mounting files</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/08-docker-networking/">Docker networking</a>
				</div>
			
		
			
				<div class="item">
					<a href="https://polarsquad.github.io/docker-basics-workshop/09-docker-compose/">Docker Compose</a>
				</div>
			
		
			
		
			
		
			
		
	</div>
</div>

					<div class="Content">
						
	<div class="Page" id="">
		<h1>Docker networking</h1>
		<p>So far we&rsquo;ve used port forwarding to access containerized services.
In this section, we&rsquo;ll briefly look into Docker&rsquo;s various networking models.</p>
<p>Docker includes following network drivers.</p>
<ul>
<li><code>bridge</code>: network bridged with the host machine</li>
<li><code>host</code>: connect container directly to the host network interface</li>
<li><code>overlay</code>: a network that spans over multiple Docker hosts</li>
<li><code>macvlan</code>: assign MAC addresses to containers, making them part of the network your host is connected to</li>
<li><code>none</code>: disable all container networking</li>
</ul>
<p>It&rsquo;s also possible to install <a href="https://docs.docker.com/engine/extend/plugins_services/">a custom network plugin</a>
to manage container networking.</p>
<p>By default, Docker will have a <code>bridge</code>, a <code>host</code>, and a <code>none</code> network available.
If not explicitly selected, the containers will use the <code>bridge</code> network by default.
This includes all the containers we&rsquo;ve run so far.
We can view these networks using the Docker CLI.</p>
<pre><code>$ docker network ls
NETWORK ID        NAME       DRIVER       SCOPE
678c7d72b948      bridge     bridge       local
4e05fb2c140c      host       host         local
dbd54eecb19d      none       null         local
</code></pre>
<h2 id="host-network">Host network</h2>
<p>Let&rsquo;s try connecting the app we created earlier to the <code>host</code> network driver.</p>
<pre><code>$ docker run --rm -d --name myapp --net host myapp
$ docker ps
CONTAINER ID     IMAGE    COMMAND             CREATED           STATUS          PORTS     NAMES
6e805ede534b     myapp    &quot;python app.py&quot;     10 seconds ago    Up 10 seconds             myapp
</code></pre>
<p>Notice how we no longer have a port mapping.
This is because the container will open the port directly on the host network.
We can test it with curl.</p>
<pre><code>$ curl http://localhost:3000/
Hello World!
</code></pre>
<p>If you have the <code>lsof</code> command installed,
you should also be able to see Python program connected to the port.</p>
<pre><code>$ sudo lsof -i TCP:3000
COMMAND   PID             USER   FD   TYPE   DEVICE SIZE/OFF NODE NAME
python  27365 systemd-coredump    3u  IPv4 35128999      0t0  TCP *:commplex-main (LISTEN)
</code></pre>
<p>Neat! Let&rsquo;s clean up the resources.</p>
<pre><code>$ docker stop myapp
</code></pre>
<h2 id="custom-networks">Custom networks</h2>
<p>The default bridge and host networks are great,
but occasionally you may need to create custom networks for your containers.
For example, you can use the custom networks to prevent containers from connecting to each other over the network.</p>
<p>Let&rsquo;s create our own bridge network using the Docker CLI.</p>
<pre><code>$ docker network create mynet
$ docker network ls
NETWORK ID       NAME      DRIVER    SCOPE
678c7d72b948     bridge    bridge    local
4e05fb2c140c     host      host      local
f8ad75fd2622     mynet     bridge    local
dbd54eecb19d     none      null      local
</code></pre>
<p>Let&rsquo;s now run our app in the network we just created.</p>
<pre><code>$ docker run --rm -d --name myapp --net mynet myapp
</code></pre>
<p>We could specify a port forwarding rule to access the app from the host, but for now we can leave it out.
Instead, let&rsquo;s run another container in the same network, that will do the HTTP request for us.
We can use <code>appropriate/curl</code> for this, which is a pre-made image with <code>curl</code> installed.</p>
<pre><code>$ docker run --rm --net mynet appropriate/curl -s http://myapp:3000/
Hello World!
</code></pre>
<p>Notice how we used the container name as part of the HTTP request address.
This works because the custom network will create internal DNS records that maps the container name to the container IP address.
If you want to find out the container IP address, you can use the <code>docker inspect</code> command.</p>
<pre><code>$ docker inspect myapp | grep IPAddress
            &quot;SecondaryIPAddresses&quot;: null,
            &quot;IPAddress&quot;: &quot;&quot;,
                    &quot;IPAddress&quot;: &quot;172.19.0.2&quot;,
$ docker run --rm --net mynet appropriate/curl -s http://172.19.0.2:3000/
Hello World!
</code></pre>
<p>To confirm the network isolation works as expected,
we can try to access our app using the <code>curl</code> container in the default network.</p>
<pre><code>$ docker run --rm appropriate/curl -m 5 http://myapp:3000/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (6) Could not resolve host: myapp
$ docker run --rm appropriate/curl -m 5 http://172.19.0.2:3000/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:--  0:00:05 --:--:--     0
curl: (28) Connection timed out after 5000 milliseconds
</code></pre>
<p>Fantastic! Let&rsquo;s clean up the resources.</p>
<pre><code>$ docker stop myapp
$ docker network rm mynet
</code></pre>
</div>

						<div class="Footer">
	<p>Made with ❤️ for Developers by Polar Squad. Content on this site is licensed under a Creative Commons license</p>
</div>
<script src="https://polarsquad.github.io/docker-basics-workshop/js/index.js"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-xxxx-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

					</div>
				</div>
		</div>
	</body>
</html>
